REM    CLOSEUP - CLOSE UP EXTRA OPERATOR REM
DEF     CLOSEUP(CUCNT, CUSTOR, CUITEM, CUOPT)
        CUCLOSEUP = 0
        IF CUCNT = 0 THEN RETURN
 CLSUPBEG:
        GOSUB GETOPT: 
        IF CUCNT = 0 THEN GOTO ENDCLSUP:
        IF CUREC > CUCNT THEN CUCNT = CUCNT - 1 : GOTO CLSUPBEG:
        IF CUREC <= CUCNT THEN CUREC = CUREC + 1 : GOTO CLSUPBEG:
 GETOPT:  
        IF CUITEM <= 0 THEN RETURN
        GOSUB FETCHOPT:
        IF CUOPT = 0 THEN CUCLOSEUP = 1
        RETURN
 FETCHOPT: 
        CURAND = VAL(RIGHT$(STR$(CUOPT),2))
        CUREC = INT(CUOPT/100)
        RETURN
ENDCLSUP:
        CLOSEUP = CUCLOSEUP
FEND"""