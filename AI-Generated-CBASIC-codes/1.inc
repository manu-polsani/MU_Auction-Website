DEF getDat(TIMETST)
    IF TIMETST>12 THEN DAYVAL=DAYVAL+1
    IF TIMETST<=12 THEN DAYVAL=DAYVAL-1
    DATRETRIEVE: GOSUB DAYCHCK:
    IF DAYVAL = 0 THEN GOTO DATSEND:
    IF DAYVAL>0 AND DATREM>=DAYVAL THEN DAYVAL=TYER*10000+DAYVAL : GOTO DATSEND:
    IF DAYVAL<0 AND DATREM<DAYVAL THEN TYER=TYER+1 : DATVAL=DATVAL-DATREM:
    DAYVAL=DAYVAL+1 : GOTO DATRETRIEVE:
    GETDAYVAL: CDATE = VAL(LEFT$(STR$(DAYVAL),2))
    TYER = INT(DAYVAL/1000)
    GOSUB GETLEAP:
    DATREM = TSTR-CDATE
    RETURN
GETLEAP: IF MOD(TYER,4)=0 THEN TSTR=367 ELSE TSTR=366
    RETURN
DATSEND: GETDAT=DAYVAL
FEND